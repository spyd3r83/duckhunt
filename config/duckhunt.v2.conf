#############################################################
#                   DuckHunt v2.0 Configuration             #
#                                                           #
#   Enhanced HID Injection Detection System                #
#   Privacy-First Behavioral Analysis                      #
#############################################################

[general]
# Protection policy: adaptive, paranoid, normal, sneaky, log
policy = adaptive

# Logging level: debug, info, warn, error
log_level = info

# Data directory for profiles and logs
data_dir = ./data

# Platform: windows, linux, macos (auto-detected if not specified)
platform = auto


[learning]
# Enable learning mode
enabled = true

# Continuous adaptive learning (recommended)
continuous = true

# Initial learning period in days before enforcement
learning_period_days = 14

# Minimum samples before enabling enforcement (10,000 recommended)
min_samples = 10000

# Learning rate for continuous adaptation (0.01 - 0.1)
# Lower = more stable, higher = faster adaptation
learning_rate = 0.05


[detection]
# Confidence threshold for blocking (0.0 - 1.0)
# 0.85 = high confidence required (recommended)
confidence_threshold = 0.85

# Legacy speed threshold in milliseconds (backwards compatible)
speed_threshold_ms = 30

# Enable pattern detection (known attack sequences)
pattern_detection = true

# Enable digraph timing analysis
digraph_analysis = true

# Enable mouse correlation (privacy-sensitive, optional)
mouse_correlation = false

# Statistical method: zscore, iqr, isolation_forest
statistical_method = zscore

# === ADVANCED DETECTION (NEW) ===
# Enables >90% detection against sophisticated evasion

# Master switch for advanced detection
advanced_detection = true

# Entropy analysis (detect synthetic randomness)
entropy_analysis = true

# Autocorrelation analysis (detect missing rhythm)
autocorrelation_analysis = true

# Variance stability analysis (detect mechanical consistency)
variance_stability_analysis = true

# Hurst exponent analysis (detect no long-range dependency)
hurst_analysis = true

# Zero error detection (detect suspiciously perfect typing)
zero_error_detection = true
zero_error_threshold_keys = 75

# Higher-order moments (skewness, kurtosis)
moments_analysis = true

# Distribution shape testing (detect too-uniform patterns)
distribution_analysis = true

# === MACHINE LEARNING (OPTIONAL) ===
# Requires: pip install scikit-learn>=1.0.0
# Achieves 94%+ detection rate

ml_detection = false
ml_model_path = ./data/ml_model.pkl
ml_contamination = 0.01
ml_auto_train = true
ml_min_training_sequences = 50


[baseline]
# Universal baseline profile for immediate protection
use_baseline = true
baseline_path = ./config/baseline.profile.json

# Minimum baseline weight (prevents profile poisoning)
min_baseline_weight = 0.05

# Transition thresholds (samples â†’ baseline weight)
# 0 samples: 100% baseline
# 1000 samples: 50% baseline
# 5000 samples: 20% baseline
# 10000+ samples: 5% baseline (minimum)


[enforcement]
# Block suspicious keystrokes (if false, log only)
block_suspicious = true

# Alert on detection
alert_on_detection = true

# Webhook URL for remote alerts (optional)
# webhook_url = https://example.com/duckhunt/alert

# Application blacklist (comma-separated)
blacklist = cmd.exe,powershell.exe,bash

# Allow auto-type software (KeePass, LastPass, etc.)
allow_auto_type_software = true


[privacy]
# Enable mouse tracking (requires elevated privileges)
enable_mouse_tracking = false

# Log retention in days (auto-delete old logs)
log_retention_days = 7

# Store window names (false = anonymize to categories)
store_window_names = false

# Anonymize all logs (hash content)
anonymize_logs = true

# Show system tray icon (user awareness)
show_tray_icon = true


[notifications]
# Show tray icon
show_tray_icon = true

# Alert on learning mode start
alert_on_learning = true

# Alert when detection occurs
alert_on_detection = true

# Alert on false positive (user can flag)
allow_false_positive_reporting = true


[advanced]
# Maximum history size (circular buffer)
max_history_size = 10000

# Profile path (JSON file)
profile_path = ./data/profile.json

# Attack log path (JSON Lines format)
attack_log_path = ./data/attacks.jsonl

# Metrics database (optional SQLite)
# metrics_db_path = ./data/metrics.db

# Performance monitoring
enable_performance_monitoring = false

# Debug mode (verbose logging)
debug_mode = false


#############################################################
# Legacy Configuration (backwards compatible with v1)      #
#############################################################

# Legacy policy names (mapped to new engine)
# paranoid = Block until password (not recommended in v2)
# normal = Temporary block
# sneaky = Random key drops
# log = Log only, no blocking

# Legacy threshold (30ms default)
threshold = 30

# Legacy history size (25 keystrokes)
size = 25

# Legacy sneaky mode drop frequency
randdrop = 6

# Legacy filename
filename = log.txt

# Legacy password (for paranoid mode)
# password = quack
